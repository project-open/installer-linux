
<html><head>
<title>tcl-lib-file - NaviServer Manual</title>
<link rel="stylesheet" href="../man.css" type="text/css">
</head>
<! -- Generated from file '/usr/local/src/naviserver/doc/html/manual/files/tcl-lib-file.html' by tcllib/doctools with format 'html'
   -->
<! -- CVS: $Id$ tcl-lib-file.n
   -->
<body><div class="doctools">
<div id="man-header">
  <a href="http://wiki.tcl.tk/2090"><img
     src="http://naviserver.sourceforge.net/ns-icon-16.png"> <strong>NaviServer</strong></a>
  - programmable web server
</div>
<br>
<hr> [
  <a href="../../toc.html">Main Table Of Contents</a>
| <a href="../toc.html">Table Of Contents</a>
| <a href="../../index.html">Keyword Index</a>
] <hr>
<h1 class="title">tcl-lib-file(n) 4.99.8 manual &quot;NaviServer Manual&quot;</h1>
<div id="name" class="section"><h2><a name="name">Name</a></h2>
<p>tcl-lib-file - Support for .tcl-style dynamic pages</p>
</div>
<div id="toc" class="section"><h2><a name="toc">Table Of Contents</a></h2>
<ul class="toc">
<li class="section"><a href="#toc">Table Of Contents</a></li>
<li class="section"><a href="#section1">Description</a></li>
<li class="section"><a href="#section2">Setting up a TCL error page</a></li>
<li class="section"><a href="#section3">Support for .tcl-style dynamic pages via ADP engine</a></li>
<li class="section"><a href="#see-also">See Also</a></li>
<li class="section"><a href="#keywords">Keywords</a></li>
</ul>
</div>
<div id="section1" class="section"><h2><a name="section1">Description</a></h2>
<p>When a client requests a page, the page can be a static or dynamic,
where the latter means that the content is computed at the time it is served. 
The dynamic content can be provided as .adp files or via .tcl files.</p>
<p>By default Tcl pages are not enabled, but can be enabled over the
configuration file of NaviServer.
Notice the entries in your sample-config.tcl configuration file:</p>
<pre class="example">
 
 ns_section &quot;ns/server/${servername}&quot;
 ns_param   enabletclpages  false         ;# Parse *.tcl files in pageroot.
</pre>
<p>If you set first option to true this is what happens at server startup when file.tcl is sourced:</p>
<ol class="enumerated">
<li><p>The procedure ns_sourceproc is registered for the HTTP methods GET, POST and HEAD via ns_register_proc.</p></li>
<li><p>The procedure ns_sourceproc works as follows:</p>
<ol class="enumerated">
  
<li><p>If a requested file does not exist on the filesystem it returns via ns_returnnotfound</p></li>
<li><p>An existing TCL file is sourced via ns_sourcefile (see above)</p></li>
<li><p>If a custom error page exists it is sourced. That error page is responsible for 
         handling the error, e.g. communication with a user.</p></li>
</ol>
</li>
</ol>
</div>
<div id="section2" class="section"><h2><a name="section2">Setting up a TCL error page</a></h2>
<p>Similar to the ADP error page example in your sample-config.tcl file you could setup a TCL error page:</p>
<pre class="example">
ns_section &quot;ns/server/${servername}/tcl&quot;
ns_param   errorpage   ${serverdir}/${pageroot}/errorpage.tcl  ;# TCL error page
</pre>
</div>
<div id="section3" class="section"><h2><a name="section3">Support for .tcl-style dynamic pages via ADP engine</a></h2>
<p>Another way to support .tcl pages to use ADP engine to process .tcl file as
ADP pages. the engine will source Tcl file and wrap it as &lt;% ns_adp_include filename %&gt;,
then compiled it as regular ADP page. If caching enabled, the tcl file will be compiled as
Tcl proc into bytecode. Using ADP engine is faster than using file.tcl based approach.</p>
<pre class="example">
ns_section &quot;ns/server/${servername}/adp&quot;
ns_param   enabletclpages  false                               ;# Parse *.tcl files in pageroot.
ns_param   errorpage   ${serverdir}/${pageroot}/errorpage.adp  ;# ADP error page
</pre>
</div>
<div id="see-also" class="section"><h2><a name="see-also">See Also</a></h2>
<p><a href="adp-overview.html">adp-overview</a>, <a href="../../index.html#key3">nsd</a></p>
</div>
<div id="keywords" class="section"><h2><a name="keywords">Keywords</a></h2>
<p><a href="../../index.html#key6">NaviServer</a>, <a href="../../index.html#key9">configuration</a></p>
</div>
<div id="man-footer">
  
</div>
</div></body></html>
